blog2(
[
  {
    "time": "2020-08-12",
    "title": "微信小程序上线调用IP+端口这样的接口",
    "sign": ["小程序"],
    "content": "    微信小程序的严格限制，上线时端口必须..."
  },
  {
    "time": "2020-05-11",
    "title": "node.js+vue实现对数据的增删改查",
    "sign": ["小程序"],
    "content": "在看本篇前你应该对我上篇文章<a href=\"./blog.html?detail=20190427()\">vue项目中如何使用express</a>有一定的了解，今天我们在那篇文章基础之上再次深入，讲一讲如何对数据进行增删改查。为了后续我们有很多数据进行管理，首先将文件目录进行了细微的调整，首先创建一个json文件夹，该文件夹存放json数据文件(因为本篇没有涉及到数据库，所以对数据的操作都是靠读取和写入文件的形式)。然后创建一个routers的文件夹，用于存放各个模块下的请求数据接口；最后创建一个index.js，这与前面两个文件处于平级；用于引入routers文件夹下的接口文件，目录结构如下：\n<img src=\"./assets/img/blog/2018-2019/2019051101.png\"></img>\n文件夹创建完成后，我们开始写接口代码了。\n首先在json文件夹下创建一个user.json文件，存放json数据，我们先初始化一条数据；数据如下：\n<code class=\"language-json\">[\n  {\n    \"username\": \"user\",\n    \"age\": 24\n  }\n]</code>\n接着我们在routers文件夹下创建一个user.js,用于写接口，代码如下：\n<code class=\"language-javascript>const express = require('express')\nconst router = express.Router()\nconst fs = require('fs')//内置的文件系统模块，用于读写文件\n//读取用户文件\nconst readFileData = (res, fn) => {\n  fs.readFile('./json/user.json', 'utf-8', (err, content) => {\n    if (err) {\n      res.send({\n        status: 400,\n        msg: '数据读取失败',\n        data: '',\n      });\n    } else {\n      let data = JSON.parse(content);\n      fn(data);\n    }\n  });\n};\nrouter.post('/getUserData',(req,res) => {\n  const reqData = req.body  //使用body-parser中间件后方可读取到请求体\n  readFileData(res,(data)=> {\n    res.send({\n      status: 200,\n      msg: '获取数据成功',\n      data: data,\n    })\n  })\n})\nmodule.exports = router\n</code>\n然后我们在index.js文件中引入user.js,代码如下：\n<code class=\"language-javascript>const express = require(\"express\");//require()方法引入express模块\nconst app = express();//express()方法，新建app\nconst bodyParser = require('body-parser'); //加载body-parser数据处理模块\napp.use(bodyParser.urlencoded({ extended: false }))//使用body-parser中间件\napp.use(bodyParser.json())\napp.all('*',function (req,res,next){\n  res.header('Access-Control-Allow-Origin','*'); //设置允许跨域访问\n  res.header('Access-Control-Allow-Headers', 'Content-Type, Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild');\n  res.header(\"Access-Control-Allow-Methods\",\"PUT,POST,GET,DELETE,OPTIONS\");\n  res.header(\"X-Powered-By\",' 3.2.1');\n  res.header(\"Content-Type\", \"application/json;charset=utf-8\");\n  next();\n\n});\n//app.listen()方法,设置监听端口\napp.listen(9000,function(){\n  console.log(\"listening port 9000...\");\n})\nconst user = require('./routers/user')\napp.use('/user',user)</code>\n最后我们在vue组件中调用接口：\n<code class=\"language-javascript\">\nmounted() {\n  this.getData()\n},\nmethods: {\n  getData() {\n    axios.post('http://localhost:9000/user/getUserData',{username: 'wu'}).then(res => {\n      console.log(res.data)\n    })\n  }\n}</code>\n打开浏览器查看打印日志：\n<img src=\"./assets/img/blog/2018-2019/2019051102.png\"></img>\n"
  }

])
